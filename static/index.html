<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta rel="icon" href="favicon.ico" type="image/gif">
<title>OVHcloud Price list | All Official OVH Prices</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://cdn.datatables.net/v/bs5/jq-3.7.0/jszip-3.10.1/dt-1.13.5/b-2.4.1/b-html5-2.4.1/datatables.min.css" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.datatables.net/v/bs5/jq-3.7.0/jszip-3.10.1/dt-1.13.5/b-2.4.1/b-html5-2.4.1/datatables.min.js"></script>
<link href="styles.css" rel="stylesheet"/>
</head>
<body data-bs-theme="dark" class="fh-fixedHeader">
    <nav>
        <svg width="79" height="41" viewBox="0 0 79 48" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path d="M73.14 2.69C76.9967 9.6413 78.7003 17.5821 78.0344 25.5036C77.3685 33.4252 74.3631 40.9701 69.4 47.18H47.96L54.56 35.51H45.83L56.12 17.38H64.9L73.14 2.71V2.69ZM30.8 47.18H8.94001C3.88432 40.9972 0.816836 33.4299 0.140434 25.4719C-0.535968 17.5139 1.21034 9.53738 5.15001 2.59L19.33 27.22L34.96 0H57.96L30.81 47.16L30.8 47.18Z"/>
        </svg>
        &nbsp;&nbsp;&nbsp;&nbsp;
        <h1 style="margin: 0;font-size: 1.8rem;">OVHcloud Pricelist</h2>

        <ul class="nav nav-pills" style="margin: 0 15px">
            <li class="nav-item"><a class="nav-link active" href="index.html" title="Get the list of all available Baremetal servers at OVHCloud">Baremetal Cloud Servers</a></li>
            <!-- <li class="nav-item"><a class="nav-link" href="privatecloud.html">Private Cloud</a></li> -->
            <!-- <li class="nav-item"><a class="nav-link" href="publiccloud.html">Public Cloud</a></li> -->
        </ul>
    </nav>
    <article id="main" class="container-fluid">
        <button type="button" class="btn btn-dark" id="btn-back-to-top">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-up" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z"/>
              </svg>
        </button>
        
        <div style="display: flex; justify-content: space-between; flex-wrap: wrap;">
            <div class="text" id="sub-list"></div>
            <div id="cache-time" class=""></div> 
        </div>
        <br>

        <table id="sd" class="table nowrap table-hover" style="display: none; width: 100%;">
            <thead id="sd-thead" class="thead-dark"></thead>
            <tbody></tbody>
        </table>
    </article>

<!-- Baremetal -->
<script type="text/javascript">
var DOWNLOAD_SVG = `<svg width="25px" height="25px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path opacity="0.5" d="M3 15C3 17.8284 3 19.2426 3.87868 20.1213C4.75736 21 6.17157 21 9 21H15C17.8284 21 19.2426 21 20.1213 20.1213C21 19.2426 21 17.8284 21 15" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M12 3V16M12 16L16 11.625M12 16L8 11.625" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
</svg>`;
var SUBSIDIARIES = ['CA', 'CZ','DE','ES','FI','FR','GB','IE','IT','LT','MA','NL','PL','PT','SN','TN','US'];
var INVISIBLE_COLUMNS = [0,6,7,9,10,11];

// SUB get parameter
var sub = new URLSearchParams(location.search).get('sub') || 'FR';
document.getElementById('sub-list').innerHTML = SUBSIDIARIES.reduce((acc, s, idx) => acc + `${idx != 0 ? '/' :''} <a href="${location.pathname}?sub=${s}">${s == sub ? '<b>'+s+'</b>' : s}</a> `, '');
var cache_bust = new Date().toDateString().replaceAll(' ','');

// Back to Top
let mybutton = document.getElementById("btn-back-to-top");
let scrollable = document.getElementById('main');
function scrollFunction(el) {
  if (el.scrollTop > 100) {
    mybutton.style.display = "block";
  } else {
    mybutton.style.display = "none";
  }
}
function backToTop() { scrollable.scrollTop = 0; scrollable.scrollTop = 0; }
scrollable.onscroll = function () { scrollFunction(scrollable); };
mybutton.addEventListener("click", backToTop);

// Fetch DATA
var url = `https://share.s3.gra.io.cloud.ovh.net/baremetal_prices/${sub.toLowerCase()}.json?cache_bust=${cache_bust}`
fetch(url).then(res => res.json()).then(res => {
    document.getElementById('cache-time').innerText = 'Last updated: ' + new Date(res.date).toString();

    // Set header
    document.querySelector('#sd > thead').innerHTML =`<tr>
        <th>Range</th>
        <th>Name</th>
        <th>CPU model</th>
        <th>CPU cores</th>
        <th>CPU threads</th>
        <th>CPU speed (GHz)</th>
        <th>CPU score</th>
        <th>RAM summary</th>
        <th>RAM (GB)</th>
        <th>RAM clock speed (GHz)</th>
        <th>RAM type</th>
        <th>Storage summary</th>
        <th>Storage RAID type</th>
        <th>Storage (TB)</th>
        <th>Disk #1 amount</th>
        <th>Disk #1 capacity</th>
        <th>Disk #1 techno</th>
        <th>Storage price per TB (${res.currency})</th>
        <th>Monthly price (${res.currency})</th>
    </tr>`;

    // Set content
    document.querySelector('#sd > tbody').innerHTML = res.plans.reduce((acc, item) => {
        var storage_amount = item['storageSpecs']['specifications']['disks'][0]['number'] * item['storageSpecs']['specifications']['disks'][0]['capacity'];
        
        // If second disk exist, we sum the amount of GB.
        if (item['storageSpecs']['specifications']['disks'].length > 1 && item['storageSpecs']['specifications']['disks'][1]['number'] != '') {
            storage_amount += item['storageSpecs']['specifications']['disks'][1]['number'] * item['storageSpecs']['specifications']['disks'][1]['capacity'];
        }
        storage_amount = Math.round(storage_amount / 1000)
        
        var range = item['range'] == 'hgr' ? 'high-grade' : item['range'];
        var server = item['invoiceName'].toLowerCase().replace('advance', 'adv').split(' ')[0]
        var url = `https://www.ovhcloud.com/en-ie/bare-metal/${range}/${server}/`;
        if (item['range'].toLowerCase() == 'kimsufi' || item['range'] == 'soyoustart') {
            url = `https://eco.ovhcloud.com/`;
        }
        
        // if (item['invoiceName'].split('-').length > 3) {
            // return acc;
        // }

        return acc + `<tr>
        <td>${item['range'].toUpperCase()} </td>
        <td><a href="${url}" target="_blank">${item['invoiceName']} </a></td>
        <td>${item['cpu']['brand']} ${item['cpu']['model']}</td>
        <td>${item['cpu']['cores']}</td>
        <td>${item['cpu']['threads']}</td>
        <td>${item['cpu']['frequency']}</td>
        <td>${item['cpu']['score']}</td>
        <td>${item['memory']['invoiceName']}</td>
        <td>${item['memory']['specifications']['size']}</td>
        <td>${item['memory']['specifications']['frequency']}</td>
        <td>${item['memory']['specifications']['ramType']}</td>
        <td>${item['storageSpecs']['invoiceName']}</td>
        <td>${item['storageSpecs']['specifications']['raid']}</td>
        <td>${storage_amount}</td>
        <td>${item['storageSpecs']['specifications']['disks'][0]['number']}</td>
        <td>${item['storageSpecs']['specifications']['disks'][0]['capacity']}</td>
        <td>${item['storageSpecs']['specifications']['disks'][0]['technology']}</td>
        <td>${(item['price'] / storage_amount).toFixed(2)}</td>
        <td>${item['price'].toFixed(2)}</td>
    </tr>`;
    }, '');


    $(document).ready(function() {
        $('#sd thead tr')
        .clone(true)
        .addClass('filters')
        .appendTo('#sd thead');

    var mytable = $('#sd').DataTable( {
        initComplete: function () {
            var api = this.api();
            
            // Set sticky action
            const el = document.getElementById("sd-thead");
            const observer = new IntersectionObserver( 
                ([e]) => e.target.classList.toggle("stuck", e.intersectionRatio < 1),
                {threshold: [1] }
            );
            observer.observe(el);

            $('#sd').show();
            api.columns().eq(0).each(function (colIdx) {
                if (INVISIBLE_COLUMNS.indexOf(colIdx) != -1) {
                    return;
                }
                var cell = $('.filters th').eq($(api.column(colIdx).header()).index());
                var title = $(cell).text();
                var width = $(cell).width() - 15;
                $(cell).html(`<input class="form-control form-control-sm" type="text" placeholder="${title}" style="max-width: ${width}px; font-size: 0.75rem;"/><div style="height: 0px"></div>`);
                $('input', $('.filters th').eq($(api.column(colIdx).header()).index()))
                    .off('keyup change')
                    .on('change', function (e) {
                        $(this).attr('title', $(this).val());
                        var regexr = '({search})';
                        var cursorPosition = this.selectionStart;
                        api.column(colIdx)
                            .search(
                                this.value != '' ? regexr.replace('{search}', '(((' + this.value + ')))') : '',
                                this.value != '',
                                this.value == ''
                            )
                            .draw();
                    })
                    .on('keyup', function (e) {
                        e.stopPropagation();
                        $(this).trigger('change');
                        $(this).focus()[0].setSelectionRange(cursorPosition, cursorPosition);
                    });
                })
            },
        header: true,
        ordering: true,
        orderCellsTop: true,
        order: [[ 18, "asc" ]],
        paging: false,
        dom: 'Bfrtip',
        columnDefs: [{ "targets": INVISIBLE_COLUMNS, "visible": false }, {'targets': [17, 18], 'type': 'num'}],
        buttons: [
            { extend: 'excel', attr: {class: 'btn btn-outline-light btn-sm buttons-csv buttons-html5'}, text: `${DOWNLOAD_SVG} Export to Excel`, exportOptions: { modifier: { page: 'current' }, action: () => api.e } },
            { extend: 'csv', attr: {class: 'btn btn-outline-light btn-sm buttons-csv buttons-html5'}, text: `${DOWNLOAD_SVG} Export to CSV`, exportOptions: { modifier: { page: 'current' } } }
        ]
    } );
    
    } );
})
</script>

</div>
</body>
</html>
